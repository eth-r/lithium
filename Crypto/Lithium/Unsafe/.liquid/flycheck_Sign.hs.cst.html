<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<html>
<head>
<title>/home/eth/src/crypto/lithium/Crypto/Lithium/Unsafe/flycheck_Sign.hs</title>
</head>
<head>
<link type='text/css' rel='stylesheet' href='liquid.css' />
</head>

<body>
<hr>
Put mouse over identifiers to see inferred types
<pre><span class=hs-linenum>  1: </span><span class='hs-comment'>{-# LANGUAGE NoImplicitPrelude #-}</span>
<span class=hs-linenum>  2: </span><span class='hs-comment'>{-# LANGUAGE TypeApplications #-}</span>
<span class=hs-linenum>  3: </span><span class='hs-comment'>{-# LANGUAGE TypeOperators #-}</span>
<span class=hs-linenum>  4: </span><span class='hs-comment'>{-# LANGUAGE TypeFamilies #-}</span>
<span class=hs-linenum>  5: </span><span class='hs-comment'>{-# LANGUAGE DataKinds #-}</span>
<span class=hs-linenum>  6: </span><span class='hs-comment'>{-# LANGUAGE DeriveA #-}</span>
<span class=hs-linenum>  7: </span><span class='hs-comment'>{-# LANGUAGE GeneralizedNewtypeDeriving #-}</span>
<span class=hs-linenum>  8: </span><span class='hs-comment'>{-# OPTIONS_HADDOCK hide, show-extensions #-}</span>
<span class=hs-linenum>  9: </span><span class='hs-comment'>{-|
Module      : Crypto.Lithium.Unsafe.Sign
Description : Ed25519 signatures made easy
Copyright   : (c) Promethea Raschke 2018
License     : public domain
Maintainer  : eth.raschke@liminal.ai
Stability   : experimental
Portability : unknown
-}</span>
<span class=hs-linenum> 18: </span><span class='hs-keyword'>module</span> <span class='hs-conid'>Crypto</span><span class='hs-varop'>.</span><span class='hs-conid'>Lithium</span><span class='hs-varop'>.</span><span class='hs-conid'>Unsafe</span><span class='hs-varop'>.</span><span class='hs-conid'>Sign</span>
<span class=hs-linenum> 19: </span>  <span class='hs-layout'>(</span> <span class='hs-conid'>SecretKey</span>
<span class=hs-linenum> 20: </span>  <span class='hs-layout'>,</span> <span class='hs-varid'>asSecretKey</span>
<span class=hs-linenum> 21: </span>  <span class='hs-layout'>,</span> <span class='hs-varid'>fromSecretKey</span>
<span class=hs-linenum> 22: </span>
<span class=hs-linenum> 23: </span>  <span class='hs-layout'>,</span> <span class='hs-conid'>PublicKey</span>
<span class=hs-linenum> 24: </span>  <span class='hs-layout'>,</span> <span class='hs-varid'>asPublicKey</span>
<span class=hs-linenum> 25: </span>  <span class='hs-layout'>,</span> <span class='hs-varid'>fromPublicKey</span>
<span class=hs-linenum> 26: </span>
<span class=hs-linenum> 27: </span>  <span class='hs-layout'>,</span> <span class='hs-conid'>Seed</span>
<span class=hs-linenum> 28: </span>  <span class='hs-layout'>,</span> <span class='hs-varid'>asSeed</span>
<span class=hs-linenum> 29: </span>  <span class='hs-layout'>,</span> <span class='hs-varid'>fromSeed</span>
<span class=hs-linenum> 30: </span>
<span class=hs-linenum> 31: </span>  <span class='hs-layout'>,</span> <span class='hs-conid'>Keypair</span>
<span class=hs-linenum> 32: </span>  <span class='hs-layout'>,</span> <span class='hs-varid'>asKeypair</span>
<span class=hs-linenum> 33: </span>  <span class='hs-layout'>,</span> <span class='hs-varid'>fromKeypair</span>
<span class=hs-linenum> 34: </span>
<span class=hs-linenum> 35: </span>  <span class='hs-layout'>,</span> <span class='hs-varid'>secretKey</span>
<span class=hs-linenum> 36: </span>  <span class='hs-layout'>,</span> <span class='hs-varid'>publicKey</span>
<span class=hs-linenum> 37: </span>
<span class=hs-linenum> 38: </span>  <span class='hs-layout'>,</span> <span class='hs-varid'>newKeypair</span>
<span class=hs-linenum> 39: </span>  <span class='hs-layout'>,</span> <span class='hs-varid'>seedKeypair</span>
<span class=hs-linenum> 40: </span>
<span class=hs-linenum> 41: </span>  <span class='hs-layout'>,</span> <span class='hs-varid'>toPublicKey</span>
<span class=hs-linenum> 42: </span>  <span class='hs-layout'>,</span> <span class='hs-varid'>toSeed</span>
<span class=hs-linenum> 43: </span>
<span class=hs-linenum> 44: </span>  <span class='hs-layout'>,</span> <span class='hs-conid'>Signed</span>
<span class=hs-linenum> 45: </span>  <span class='hs-layout'>,</span> <span class='hs-varid'>asSigned</span>
<span class=hs-linenum> 46: </span>  <span class='hs-layout'>,</span> <span class='hs-varid'>fromSigned</span>
<span class=hs-linenum> 47: </span>
<span class=hs-linenum> 48: </span>  <span class='hs-layout'>,</span> <span class='hs-conid'>Signature</span>
<span class=hs-linenum> 49: </span>  <span class='hs-layout'>,</span> <span class='hs-varid'>asSignature</span>
<span class=hs-linenum> 50: </span>  <span class='hs-layout'>,</span> <span class='hs-varid'>fromSignature</span>
<span class=hs-linenum> 51: </span>
<span class=hs-linenum> 52: </span>  <span class='hs-layout'>,</span> <span class='hs-varid'>sign</span>
<span class=hs-linenum> 53: </span>  <span class='hs-layout'>,</span> <span class='hs-varid'>openSigned</span>
<span class=hs-linenum> 54: </span>
<span class=hs-linenum> 55: </span>  <span class='hs-layout'>,</span> <span class='hs-varid'>signDetached</span>
<span class=hs-linenum> 56: </span>  <span class='hs-layout'>,</span> <span class='hs-varid'>verifyDetached</span>
<span class=hs-linenum> 57: </span>
<span class=hs-linenum> 58: </span>  <span class='hs-layout'>,</span> <span class='hs-conid'>SecretKeyBytes</span>
<span class=hs-linenum> 59: </span>  <span class='hs-layout'>,</span> <span class='hs-varid'>secretKeyBytes</span>
<span class=hs-linenum> 60: </span>  <span class='hs-layout'>,</span> <span class='hs-varid'>secretKeySize</span>
<span class=hs-linenum> 61: </span>
<span class=hs-linenum> 62: </span>  <span class='hs-layout'>,</span> <span class='hs-conid'>PublicKeyBytes</span>
<span class=hs-linenum> 63: </span>  <span class='hs-layout'>,</span> <span class='hs-varid'>publicKeyBytes</span>
<span class=hs-linenum> 64: </span>  <span class='hs-layout'>,</span> <span class='hs-varid'>publicKeySize</span>
<span class=hs-linenum> 65: </span>
<span class=hs-linenum> 66: </span>  <span class='hs-layout'>,</span> <span class='hs-conid'>KeypairBytes</span>
<span class=hs-linenum> 67: </span>  <span class='hs-layout'>,</span> <span class='hs-varid'>keypairBytes</span>
<span class=hs-linenum> 68: </span>  <span class='hs-layout'>,</span> <span class='hs-varid'>keypairSize</span>
<span class=hs-linenum> 69: </span>
<span class=hs-linenum> 70: </span>  <span class='hs-layout'>,</span> <span class='hs-conid'>SeedBytes</span>
<span class=hs-linenum> 71: </span>  <span class='hs-layout'>,</span> <span class='hs-varid'>seedBytes</span>
<span class=hs-linenum> 72: </span>  <span class='hs-layout'>,</span> <span class='hs-varid'>seedSize</span>
<span class=hs-linenum> 73: </span>
<span class=hs-linenum> 74: </span>  <span class='hs-layout'>,</span> <span class='hs-conid'>SignatureBytes</span>
<span class=hs-linenum> 75: </span>  <span class='hs-layout'>,</span> <span class='hs-varid'>signatureBytes</span>
<span class=hs-linenum> 76: </span>  <span class='hs-layout'>,</span> <span class='hs-varid'>signatureSize</span>
<span class=hs-linenum> 77: </span>  <span class='hs-layout'>)</span> <span class='hs-keyword'>where</span>
<span class=hs-linenum> 78: </span>
<span class=hs-linenum> 79: </span><span class='hs-keyword'>import</span> <span class='hs-conid'>Foundation</span> <span class='hs-varid'>hiding</span> <span class='hs-layout'>(</span><span class='hs-conid'>Signed</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 80: </span>
<span class=hs-linenum> 81: </span><span class='hs-keyword'>import</span> <span class='hs-conid'>Data</span><span class='hs-varop'>.</span><span class='hs-conid'>ByteArray</span> <span class='hs-keyword'>as</span> <span class='hs-conid'>B</span>
<span class=hs-linenum> 82: </span>
<span class=hs-linenum> 83: </span><span class='hs-keyword'>import</span> <span class='hs-conid'>Crypto</span><span class='hs-varop'>.</span><span class='hs-conid'>Lithium</span><span class='hs-varop'>.</span><span class='hs-conid'>Internal</span><span class='hs-varop'>.</span><span class='hs-conid'>Sign</span>
<span class=hs-linenum> 84: </span><span class='hs-keyword'>import</span> <span class='hs-conid'>Crypto</span><span class='hs-varop'>.</span><span class='hs-conid'>Lithium</span><span class='hs-varop'>.</span><span class='hs-conid'>Internal</span><span class='hs-varop'>.</span><span class='hs-conid'>Util</span>
<span class=hs-linenum> 85: </span><span class='hs-keyword'>import</span> <span class='hs-conid'>Crypto</span><span class='hs-varop'>.</span><span class='hs-conid'>Lithium</span><span class='hs-varop'>.</span><span class='hs-conid'>Unsafe</span><span class='hs-varop'>.</span><span class='hs-conid'>Types</span>
<span class=hs-linenum> 86: </span>
<span class=hs-linenum> 87: </span><span class='hs-keyword'>import</span> <span class='hs-conid'>Control</span><span class='hs-varop'>.</span><span class='hs-conid'>DeepSeq</span>
<span class=hs-linenum> 88: </span><span class='hs-comment'>{-|
Opaque 'sign' secret key type, wrapping the sensitive data in 'ScrubbedBytes' to
reduce exposure to dangers.
-}</span>
<span class=hs-linenum> 92: </span><span class='hs-keyword'>newtype</span> <span class='hs-conid'>SecretKey</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>S</span> <span class='hs-layout'>(</span><span class='hs-conid'>SecretN</span> <span class='hs-conid'>SecretKeyBytes</span><span class='hs-layout'>)</span> <span class='hs-keyword'>deriving</span> <span class='hs-layout'>(</span><span class='hs-conid'>Show</span><span class='hs-layout'>,</span> <span class='hs-conid'>Eq</span><span class='hs-layout'>,</span> <span class='hs-conid'>NFData</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 93: </span>
<span class=hs-linenum> 94: </span><span class='hs-comment'>{-|
Function for interpreting arbitrary bytes as a 'SecretKey'

Note that this allows insecure handling of key material. This function is only
exported in the "Crypto.Lithium.Unsafe.Sign" API.
-}</span>
<span class=hs-linenum>100: </span><span class='hs-definition'>asSecretKey</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>SecretN</span> <span class='hs-conid'>SecretKeyBytes</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>SecretKey</span>
<span class=hs-linenum>101: </span><span class='hs-definition'>asSecretKey</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>S</span>
<span class=hs-linenum>102: </span>
<span class=hs-linenum>103: </span><span class='hs-comment'>{-|
Function for converting a 'SecretKey' into an arbitrary byte array

Note that this allows insecure handling of key material. This function is only
exported in the "Crypto.Lithium.Unsafe.Sign" API.
-}</span>
<span class=hs-linenum>109: </span><span class='hs-definition'>fromSecretKey</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>SecretKey</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>SecretN</span> <span class='hs-conid'>SecretKeyBytes</span>
<span class=hs-linenum>110: </span><span class='hs-definition'>fromSecretKey</span> <span class='hs-layout'>(</span><span class='hs-conid'>S</span> <span class='hs-varid'>k</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>k</span>
<span class=hs-linenum>111: </span>
<span class=hs-linenum>112: </span>
<span class=hs-linenum>113: </span><span class='hs-comment'>{-|
Opaque 'sign' public key type
-}</span>
<span class=hs-linenum>116: </span><span class='hs-keyword'>newtype</span> <span class='hs-conid'>PublicKey</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>P</span> <span class='hs-layout'>(</span><span class='hs-conid'>BytesN</span> <span class='hs-conid'>PublicKeyBytes</span><span class='hs-layout'>)</span> <span class='hs-keyword'>deriving</span> <span class='hs-layout'>(</span><span class='hs-conid'>Show</span><span class='hs-layout'>,</span> <span class='hs-conid'>Eq</span><span class='hs-layout'>,</span> <span class='hs-conid'>NFData</span><span class='hs-layout'>)</span>
<span class=hs-linenum>117: </span>
<span class=hs-linenum>118: </span><span class='hs-comment'>{-|
Function for interpreting an arbitrary byte array as a 'PublicKey'


-}</span>
<span class=hs-linenum>123: </span><span class='hs-definition'>asPublicKey</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>BytesN</span> <span class='hs-conid'>PublicKeyBytes</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>PublicKey</span>
<span class=hs-linenum>124: </span><span class='hs-definition'>asPublicKey</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>P</span>
<span class=hs-linenum>125: </span>
<span class=hs-linenum>126: </span><span class='hs-definition'>fromPublicKey</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>PublicKey</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>BytesN</span> <span class='hs-conid'>PublicKeyBytes</span>
<span class=hs-linenum>127: </span><span class='hs-definition'>fromPublicKey</span> <span class='hs-layout'>(</span><span class='hs-conid'>P</span> <span class='hs-varid'>k</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>k</span>
<span class=hs-linenum>128: </span>
<span class=hs-linenum>129: </span>
<span class=hs-linenum>130: </span><span class='hs-keyword'>data</span> <span class='hs-conid'>Keypair</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>KP</span> <span class='hs-conid'>SecretKey</span> <span class='hs-conid'>PublicKey</span> <span class='hs-keyword'>deriving</span> <span class='hs-layout'>(</span><span class='hs-conid'>Show</span><span class='hs-layout'>,</span> <span class='hs-conid'>Eq</span><span class='hs-layout'>,</span> <span class='hs-conid'>NFData</span><span class='hs-layout'>)</span>
<span class=hs-linenum>131: </span>
<span class=hs-linenum>132: </span><span class='hs-definition'>publicKey</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Keypair</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>PublicKey</span>
<span class=hs-linenum>133: </span><span class='hs-definition'>publicKey</span> <span class='hs-layout'>(</span><span class='hs-conid'>KP</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>pk</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>pk</span>
<span class=hs-linenum>134: </span>
<span class=hs-linenum>135: </span><span class='hs-definition'>secretKey</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Keypair</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>SecretKey</span>
<span class=hs-linenum>136: </span><span class='hs-definition'>secretKey</span> <span class='hs-layout'>(</span><span class='hs-conid'>KP</span> <span class='hs-varid'>sk</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>sk</span>
<span class=hs-linenum>137: </span>
<span class=hs-linenum>138: </span><span class='hs-definition'>asKeypair</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>SecretN</span> <span class='hs-conid'>KeypairBytes</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Keypair</span>
<span class=hs-linenum>139: </span><span class='hs-definition'>asKeypair</span> <span class='hs-varid'>s</span> <span class='hs-keyglyph'>=</span>
<span class=hs-linenum>140: </span>  <span class='hs-keyword'>let</span> <span class='hs-layout'>(</span><span class='hs-varid'>sk</span><span class='hs-layout'>,</span> <span class='hs-varid'>pk</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>splitSecretN</span> <span class='hs-layout'>(</span><span class='hs-conid'>ByteSize</span> <span class='hs-keyglyph'>@</span><span class='hs-conid'>SecretKeyBytes</span><span class='hs-layout'>)</span> <span class='hs-varid'>s</span>
<span class=hs-linenum>141: </span>  <span class='hs-keyword'>in</span> <span class='hs-conid'>KP</span> <span class='hs-layout'>(</span><span class='hs-conid'>S</span> <span class='hs-varid'>sk</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>P</span> <span class='hs-varop'>$</span> <span class='hs-conid'>B</span><span class='hs-varop'>.</span><span class='hs-varid'>convert</span> <span class='hs-varop'>$</span> <span class='hs-varid'>reveal</span> <span class='hs-varid'>pk</span><span class='hs-layout'>)</span>
<span class=hs-linenum>142: </span>
<span class=hs-linenum>143: </span><span class='hs-definition'>fromKeypair</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Keypair</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>SecretN</span> <span class='hs-conid'>KeypairBytes</span>
<span class=hs-linenum>144: </span><span class='hs-definition'>fromKeypair</span> <span class='hs-layout'>(</span><span class='hs-conid'>KP</span> <span class='hs-layout'>(</span><span class='hs-conid'>S</span> <span class='hs-varid'>sk</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>P</span> <span class='hs-varid'>pk</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span>
<span class=hs-linenum>145: </span>  <span class='hs-varid'>appendSecretsN</span> <span class='hs-varid'>sk</span> <span class='hs-varop'>$</span> <span class='hs-varid'>makeSecretN</span> <span class='hs-varid'>pk</span>
<span class=hs-linenum>146: </span>
<span class=hs-linenum>147: </span><span class='hs-keyword'>newtype</span> <span class='hs-conid'>Seed</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Seed</span> <span class='hs-layout'>(</span><span class='hs-conid'>SecretN</span> <span class='hs-conid'>SeedBytes</span><span class='hs-layout'>)</span> <span class='hs-keyword'>deriving</span> <span class='hs-layout'>(</span><span class='hs-conid'>Show</span><span class='hs-layout'>,</span> <span class='hs-conid'>Eq</span><span class='hs-layout'>,</span> <span class='hs-conid'>NFData</span><span class='hs-layout'>)</span>
<span class=hs-linenum>148: </span>
<span class=hs-linenum>149: </span><span class='hs-definition'>asSeed</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>SecretN</span> <span class='hs-conid'>SeedBytes</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Seed</span>
<span class=hs-linenum>150: </span><span class='hs-definition'>asSeed</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Seed</span>
<span class=hs-linenum>151: </span>
<span class=hs-linenum>152: </span><span class='hs-definition'>fromSeed</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Seed</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>SecretN</span> <span class='hs-conid'>SeedBytes</span>
<span class=hs-linenum>153: </span><span class='hs-definition'>fromSeed</span> <span class='hs-layout'>(</span><span class='hs-conid'>Seed</span> <span class='hs-varid'>s</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>s</span>
<span class=hs-linenum>154: </span>
<span class=hs-linenum>155: </span><span class='hs-keyword'>newtype</span> <span class='hs-conid'>Signed</span> <span class='hs-varid'>m</span> <span class='hs-varid'>t</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Signed</span>
<span class=hs-linenum>156: </span>  <span class='hs-layout'>{</span> <span class='hs-varid'>fromSigned</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>t</span> <span class='hs-layout'>}</span> <span class='hs-keyword'>deriving</span> <span class='hs-layout'>(</span><span class='hs-conid'>Show</span><span class='hs-layout'>,</span> <span class='hs-conid'>Eq</span><span class='hs-layout'>,</span> <span class='hs-conid'>NFData</span><span class='hs-layout'>)</span>
<span class=hs-linenum>157: </span>
<span class=hs-linenum>158: </span><span class='hs-definition'>asSigned</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Plaintext</span> <span class='hs-varid'>m</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>Bytes</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Signed</span> <span class='hs-varid'>m</span>
<span class=hs-linenum>159: </span><span class='hs-definition'>asSigned</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Signed</span>
<span class=hs-linenum>160: </span>
<span class=hs-linenum>161: </span><span class='hs-keyword'>newtype</span> <span class='hs-conid'>Signature</span> <span class='hs-varid'>m</span> <span class='hs-varid'>t</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Signature</span>
<span class=hs-linenum>162: </span>  <span class='hs-layout'>{</span> <span class='hs-varid'>fromSignature</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>N</span> <span class='hs-conid'>SignatureBytes</span> <span class='hs-varid'>t</span> <span class='hs-layout'>}</span> <span class='hs-keyword'>deriving</span> <span class='hs-layout'>(</span><span class='hs-conid'>Show</span><span class='hs-layout'>,</span> <span class='hs-conid'>Eq</span><span class='hs-layout'>,</span> <span class='hs-conid'>NFData</span><span class='hs-layout'>)</span>
<span class=hs-linenum>163: </span>
<span class=hs-linenum>164: </span><span class='hs-keyword'>instance</span> <span class='hs-conid'>ByteArrayAccess</span> <span class='hs-layout'>(</span><span class='hs-conid'>Signature</span> <span class='hs-varid'>m</span> <span class='hs-varid'>t</span><span class='hs-layout'>)</span> <span class='hs-keyword'>where</span>
<span class=hs-linenum>165: </span>  <span class='hs-varid'>length</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>signatureSize</span>
<span class=hs-linenum>166: </span>  <span class='hs-varid'>withByteArray</span> <span class='hs-layout'>(</span><span class='hs-conid'>Signature</span> <span class='hs-varid'>s</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>withByteArray</span> <span class='hs-varid'>s</span>
<span class=hs-linenum>167: </span>
<span class=hs-linenum>168: </span><span class='hs-definition'>asSignature</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>ByteArrayAccess</span> <span class='hs-varid'>m</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>BytesN</span> <span class='hs-conid'>SignatureBytes</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Signature</span> <span class='hs-varid'>m</span>
<span class=hs-linenum>169: </span><span class='hs-definition'>asSignature</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Signature</span>
<span class=hs-linenum>170: </span>
<span class=hs-linenum>171: </span><span class='hs-definition'>newKeypair</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>IO</span> <span class='hs-conid'>Keypair</span>
<span class=hs-linenum>172: </span><span class='hs-definition'>newKeypair</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>withLithium</span> <span class='hs-varop'>$</span> <span class='hs-keyword'>do</span>
<span class=hs-linenum>173: </span>  <span class='hs-layout'>(</span><span class='hs-layout'>(</span><span class='hs-sel'>_e</span><span class='hs-layout'>,</span> <span class='hs-varid'>sk</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span> <span class='hs-varid'>pk</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>&lt;-</span>
<span class=hs-linenum>174: </span>    <span class='hs-varid'>allocBytesN</span> <span class='hs-varid'>publicKeyBytes</span> <span class='hs-varop'>$</span> <span class='hs-keyglyph'>\</span><span class='hs-varid'>ppk</span> <span class='hs-keyglyph'>-&gt;</span>
<span class=hs-linenum>175: </span>    <span class='hs-varid'>allocSecretN</span> <span class='hs-varid'>secretKeyBytes</span> <span class='hs-varop'>$</span> <span class='hs-keyglyph'>\</span><span class='hs-varid'>psk</span> <span class='hs-keyglyph'>-&gt;</span>
<span class=hs-linenum>176: </span>    <span class='hs-varid'>sodium_sign_keypair</span> <span class='hs-varid'>ppk</span> <span class='hs-varid'>psk</span>
<span class=hs-linenum>177: </span>  <span class='hs-keyword'>let</span> <span class='hs-varid'>sk'</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>S</span> <span class='hs-varid'>sk</span>
<span class=hs-linenum>178: </span>      <span class='hs-varid'>pk'</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>P</span> <span class='hs-varid'>pk</span>
<span class=hs-linenum>179: </span>  <span class='hs-varid'>return</span> <span class='hs-varop'>$</span> <span class='hs-conid'>KP</span> <span class='hs-layout'>(</span><span class='hs-varid'>sk'</span><span class='hs-layout'>,</span> <span class='hs-varid'>pk'</span><span class='hs-layout'>)</span>
<span class=hs-linenum>180: </span>
<span class=hs-linenum>181: </span><span class='hs-definition'>seedKeypair</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Seed</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Keypair</span>
<span class=hs-linenum>182: </span><span class='hs-definition'>seedKeypair</span> <span class='hs-layout'>(</span><span class='hs-conid'>Seed</span> <span class='hs-varid'>s</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>withLithium</span> <span class='hs-varop'>$</span>
<span class=hs-linenum>183: </span>  <span class='hs-keyword'>let</span> <span class='hs-layout'>(</span><span class='hs-layout'>(</span><span class='hs-sel'>_e</span><span class='hs-layout'>,</span> <span class='hs-varid'>sk</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span> <span class='hs-varid'>pk</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>unsafePerformIO</span> <span class='hs-varop'>$</span>
<span class=hs-linenum>184: </span>        <span class='hs-varid'>allocBytesN</span> <span class='hs-varid'>publicKeyBytes</span> <span class='hs-varop'>$</span> <span class='hs-keyglyph'>\</span><span class='hs-varid'>ppk</span> <span class='hs-keyglyph'>-&gt;</span>
<span class=hs-linenum>185: </span>        <span class='hs-varid'>allocSecretN</span> <span class='hs-varid'>secretKeyBytes</span> <span class='hs-varop'>$</span> <span class='hs-keyglyph'>\</span><span class='hs-varid'>psk</span> <span class='hs-keyglyph'>-&gt;</span>
<span class=hs-linenum>186: </span>        <span class='hs-varid'>withSecretN</span> <span class='hs-varid'>s</span> <span class='hs-varop'>$</span> <span class='hs-keyglyph'>\</span><span class='hs-varid'>ps</span> <span class='hs-keyglyph'>-&gt;</span>
<span class=hs-linenum>187: </span>        <span class='hs-varid'>sodium_sign_seed_keypair</span> <span class='hs-varid'>ppk</span> <span class='hs-varid'>psk</span> <span class='hs-varid'>ps</span>
<span class=hs-linenum>188: </span>      <span class='hs-varid'>sk'</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>S</span> <span class='hs-varid'>sk</span>
<span class=hs-linenum>189: </span>      <span class='hs-varid'>pk'</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>P</span> <span class='hs-varid'>pk</span>
<span class=hs-linenum>190: </span>  <span class='hs-keyword'>in</span> <span class='hs-layout'>(</span><span class='hs-conid'>KP</span> <span class='hs-layout'>(</span><span class='hs-varid'>sk'</span><span class='hs-layout'>,</span> <span class='hs-varid'>pk'</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<span class=hs-linenum>191: </span>
<span class=hs-linenum>192: </span><span class='hs-definition'>toPublicKey</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>SecretKey</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>PublicKey</span>
<span class=hs-linenum>193: </span><span class='hs-definition'>toPublicKey</span> <span class='hs-layout'>(</span><span class='hs-conid'>S</span> <span class='hs-varid'>sk</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>withLithium</span> <span class='hs-varop'>$</span>
<span class=hs-linenum>194: </span>  <span class='hs-keyword'>let</span> <span class='hs-layout'>(</span><span class='hs-sel'>_e</span><span class='hs-layout'>,</span> <span class='hs-varid'>pk</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>unsafePerformIO</span> <span class='hs-varop'>$</span>
<span class=hs-linenum>195: </span>        <span class='hs-varid'>allocBytesN</span> <span class='hs-varid'>publicKeyBytes</span> <span class='hs-varop'>$</span> <span class='hs-keyglyph'>\</span><span class='hs-varid'>ppk</span> <span class='hs-keyglyph'>-&gt;</span>
<span class=hs-linenum>196: </span>        <span class='hs-varid'>withSecretN</span> <span class='hs-varid'>sk</span> <span class='hs-varop'>$</span> <span class='hs-keyglyph'>\</span><span class='hs-varid'>psk</span> <span class='hs-keyglyph'>-&gt;</span>
<span class=hs-linenum>197: </span>        <span class='hs-varid'>sodium_sign_sk_to_pk</span> <span class='hs-varid'>ppk</span> <span class='hs-varid'>psk</span>
<span class=hs-linenum>198: </span>  <span class='hs-keyword'>in</span> <span class='hs-layout'>(</span><span class='hs-conid'>P</span> <span class='hs-varid'>pk</span><span class='hs-layout'>)</span>
<span class=hs-linenum>199: </span>
<span class=hs-linenum>200: </span><span class='hs-definition'>toSeed</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>SecretKey</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Seed</span>
<span class=hs-linenum>201: </span><span class='hs-definition'>toSeed</span> <span class='hs-layout'>(</span><span class='hs-conid'>S</span> <span class='hs-varid'>sk</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>withLithium</span> <span class='hs-varop'>$</span>
<span class=hs-linenum>202: </span>  <span class='hs-keyword'>let</span> <span class='hs-layout'>(</span><span class='hs-sel'>_e</span><span class='hs-layout'>,</span> <span class='hs-varid'>seed</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>unsafePerformIO</span> <span class='hs-varop'>$</span>
<span class=hs-linenum>203: </span>        <span class='hs-varid'>allocSecretN</span> <span class='hs-varid'>seedBytes</span> <span class='hs-varop'>$</span> <span class='hs-keyglyph'>\</span><span class='hs-varid'>pSeed</span> <span class='hs-keyglyph'>-&gt;</span>
<span class=hs-linenum>204: </span>        <span class='hs-varid'>withSecretN</span> <span class='hs-varid'>sk</span> <span class='hs-varop'>$</span> <span class='hs-keyglyph'>\</span><span class='hs-varid'>pSk</span> <span class='hs-keyglyph'>-&gt;</span>
<span class=hs-linenum>205: </span>        <span class='hs-varid'>sodium_sign_sk_to_seed</span> <span class='hs-varid'>pSeed</span> <span class='hs-varid'>pSk</span>
<span class=hs-linenum>206: </span>  <span class='hs-keyword'>in</span> <span class='hs-layout'>(</span><span class='hs-conid'>Seed</span> <span class='hs-varid'>seed</span><span class='hs-layout'>)</span>
<span class=hs-linenum>207: </span>
<span class=hs-linenum>208: </span><span class='hs-definition'>sign</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Plaintext</span> <span class='hs-varid'>m</span>
<span class=hs-linenum>209: </span>     <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>SecretKey</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>m</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Signed</span> <span class='hs-varid'>m</span>
<span class=hs-linenum>210: </span><span class='hs-definition'>sign</span> <span class='hs-layout'>(</span><span class='hs-conid'>S</span> <span class='hs-varid'>sk</span><span class='hs-layout'>)</span> <span class='hs-varid'>message</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>withLithium</span> <span class='hs-varop'>$</span>
<span class=hs-linenum>211: </span>  <span class='hs-keyword'>let</span> <span class='hs-varid'>mlen</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>plaintextLength</span> <span class='hs-varid'>message</span>
<span class=hs-linenum>212: </span>      <span class='hs-varid'>mlenC</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>fromIntegral</span> <span class='hs-varid'>mlen</span>
<span class=hs-linenum>213: </span>      <span class='hs-varid'>slen</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>mlen</span> <span class='hs-varop'>+</span> <span class='hs-varid'>signatureSize</span>
<span class=hs-linenum>214: </span>      <span class='hs-layout'>(</span><span class='hs-sel'>_e</span><span class='hs-layout'>,</span> <span class='hs-varid'>signed</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>unsafePerformIO</span> <span class='hs-varop'>$</span>
<span class=hs-linenum>215: </span>        <span class='hs-varid'>allocRet</span> <span class='hs-varid'>slen</span> <span class='hs-varop'>$</span> <span class='hs-keyglyph'>\</span><span class='hs-varid'>psigned</span> <span class='hs-keyglyph'>-&gt;</span>
<span class=hs-linenum>216: </span>        <span class='hs-varid'>withSecretN</span> <span class='hs-varid'>sk</span> <span class='hs-varop'>$</span> <span class='hs-keyglyph'>\</span><span class='hs-varid'>pkey</span> <span class='hs-keyglyph'>-&gt;</span>
<span class=hs-linenum>217: </span>        <span class='hs-varid'>withPlaintext</span> <span class='hs-varid'>message</span> <span class='hs-varop'>$</span> <span class='hs-keyglyph'>\</span><span class='hs-varid'>pmessage</span> <span class='hs-keyglyph'>-&gt;</span>
<span class=hs-linenum>218: </span>        <span class='hs-varid'>sodium_sign</span> <span class='hs-varid'>psigned</span>
<span class=hs-linenum>219: </span>                    <span class='hs-varid'>nullPtr</span>
<span class=hs-linenum>220: </span>                    <span class='hs-varid'>pmessage</span> <span class='hs-varid'>mlenC</span>
<span class=hs-linenum>221: </span>                    <span class='hs-varid'>pkey</span>
<span class=hs-linenum>222: </span>  <span class='hs-keyword'>in</span> <span class='hs-layout'>(</span><span class='hs-conid'>Signed</span> <span class='hs-varid'>signed</span><span class='hs-layout'>)</span>
<span class=hs-linenum>223: </span>
<span class=hs-linenum>224: </span><span class='hs-definition'>openSigned</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Plaintext</span> <span class='hs-varid'>m</span>
<span class=hs-linenum>225: </span>           <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>PublicKey</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Signed</span> <span class='hs-varid'>m</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Maybe</span> <span class='hs-varid'>m</span>
<span class=hs-linenum>226: </span><span class='hs-definition'>openSigned</span> <span class='hs-layout'>(</span><span class='hs-conid'>P</span> <span class='hs-varid'>pk</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>Signed</span> <span class='hs-varid'>signed</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>withLithium</span> <span class='hs-varop'>$</span>
<span class=hs-linenum>227: </span>  <span class='hs-keyword'>let</span> <span class='hs-varid'>slen</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>B</span><span class='hs-varop'>.</span><span class='hs-varid'>length</span> <span class='hs-varid'>signed</span>
<span class=hs-linenum>228: </span>      <span class='hs-varid'>mlen</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>slen</span> <span class='hs-comment'>-</span> <span class='hs-varid'>signatureSize</span>
<span class=hs-linenum>229: </span>      <span class='hs-varid'>slenC</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>fromIntegral</span> <span class='hs-varid'>slen</span>
<span class=hs-linenum>230: </span>      <span class='hs-layout'>(</span><span class='hs-varid'>e</span><span class='hs-layout'>,</span> <span class='hs-varid'>message</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>unsafePerformIO</span> <span class='hs-varop'>$</span>
<span class=hs-linenum>231: </span>        <span class='hs-varid'>allocRet</span> <span class='hs-varid'>mlen</span> <span class='hs-varop'>$</span> <span class='hs-keyglyph'>\</span><span class='hs-varid'>pmessage</span> <span class='hs-keyglyph'>-&gt;</span>
<span class=hs-linenum>232: </span>        <span class='hs-varid'>withBytesN</span> <span class='hs-varid'>pk</span> <span class='hs-varop'>$</span> <span class='hs-keyglyph'>\</span><span class='hs-varid'>pkey</span> <span class='hs-keyglyph'>-&gt;</span>
<span class=hs-linenum>233: </span>        <span class='hs-varid'>withByteArray</span> <span class='hs-varid'>signed</span> <span class='hs-varop'>$</span> <span class='hs-keyglyph'>\</span><span class='hs-varid'>psigned</span> <span class='hs-keyglyph'>-&gt;</span>
<span class=hs-linenum>234: </span>        <span class='hs-varid'>sodium_sign_open</span> <span class='hs-varid'>pmessage</span> <span class='hs-varid'>nullPtr</span> <span class='hs-varid'>psigned</span> <span class='hs-varid'>slenC</span> <span class='hs-varid'>pkey</span>
<span class=hs-linenum>235: </span>  <span class='hs-keyword'>in</span> <span class='hs-keyword'>case</span> <span class='hs-varid'>e</span> <span class='hs-keyword'>of</span>
<span class=hs-linenum>236: </span>    <span class='hs-num'>0</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>fromPlaintext</span> <span class='hs-varid'>message</span>
<span class=hs-linenum>237: </span>    <span class='hs-keyword'>_</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Nothing</span>
<span class=hs-linenum>238: </span>
<span class=hs-linenum>239: </span><span class='hs-definition'>signDetached</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Plaintext</span> <span class='hs-varid'>m</span>
<span class=hs-linenum>240: </span>             <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>SecretKey</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>m</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Signature</span> <span class='hs-varid'>m</span>
<span class=hs-linenum>241: </span><span class='hs-definition'>signDetached</span> <span class='hs-layout'>(</span><span class='hs-conid'>S</span> <span class='hs-varid'>k</span><span class='hs-layout'>)</span> <span class='hs-varid'>message</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>withLithium</span> <span class='hs-varop'>$</span>
<span class=hs-linenum>242: </span>  <span class='hs-keyword'>let</span> <span class='hs-varid'>mlenC</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>fromIntegral</span> <span class='hs-varop'>$</span> <span class='hs-varid'>plaintextLength</span> <span class='hs-varid'>message</span>
<span class=hs-linenum>243: </span>      <span class='hs-layout'>(</span><span class='hs-sel'>_e</span><span class='hs-layout'>,</span> <span class='hs-varid'>signature</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>unsafePerformIO</span> <span class='hs-varop'>$</span>
<span class=hs-linenum>244: </span>        <span class='hs-varid'>allocBytesN</span> <span class='hs-varid'>signatureBytes</span> <span class='hs-varop'>$</span> <span class='hs-keyglyph'>\</span><span class='hs-varid'>psignature</span> <span class='hs-keyglyph'>-&gt;</span>
<span class=hs-linenum>245: </span>        <span class='hs-varid'>withSecretN</span> <span class='hs-varid'>k</span> <span class='hs-varop'>$</span> <span class='hs-keyglyph'>\</span><span class='hs-varid'>pkey</span> <span class='hs-keyglyph'>-&gt;</span>
<span class=hs-linenum>246: </span>        <span class='hs-varid'>withPlaintext</span> <span class='hs-varid'>message</span> <span class='hs-varop'>$</span> <span class='hs-keyglyph'>\</span><span class='hs-varid'>pmessage</span> <span class='hs-keyglyph'>-&gt;</span>
<span class=hs-linenum>247: </span>        <span class='hs-varid'>sodium_sign_detached</span> <span class='hs-varid'>psignature</span> <span class='hs-varid'>nullPtr</span>
<span class=hs-linenum>248: </span>                             <span class='hs-varid'>pmessage</span> <span class='hs-varid'>mlenC</span>
<span class=hs-linenum>249: </span>                             <span class='hs-varid'>pkey</span>
<span class=hs-linenum>250: </span>  <span class='hs-keyword'>in</span> <span class='hs-layout'>(</span><span class='hs-conid'>Signature</span> <span class='hs-varid'>signature</span><span class='hs-layout'>)</span>
<span class=hs-linenum>251: </span>
<span class=hs-linenum>252: </span><span class='hs-definition'>verifyDetached</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Plaintext</span> <span class='hs-varid'>m</span>
<span class=hs-linenum>253: </span>               <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>PublicKey</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Signature</span> <span class='hs-varid'>m</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>m</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Bool</span>
<span class=hs-linenum>254: </span><span class='hs-definition'>verifyDetached</span> <span class='hs-layout'>(</span><span class='hs-conid'>P</span> <span class='hs-varid'>k</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>Signature</span> <span class='hs-varid'>signature</span><span class='hs-layout'>)</span> <span class='hs-varid'>message</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>withLithium</span> <span class='hs-varop'>$</span>
<span class=hs-linenum>255: </span>  <span class='hs-keyword'>let</span> <span class='hs-varid'>mlenC</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>fromIntegral</span> <span class='hs-varop'>$</span> <span class='hs-varid'>plaintextLength</span> <span class='hs-varid'>message</span>
<span class=hs-linenum>256: </span>      <span class='hs-varid'>e</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>unsafePerformIO</span> <span class='hs-varop'>$</span>
<span class=hs-linenum>257: </span>        <span class='hs-varid'>withBytesN</span> <span class='hs-varid'>k</span> <span class='hs-varop'>$</span> <span class='hs-keyglyph'>\</span><span class='hs-varid'>pkey</span> <span class='hs-keyglyph'>-&gt;</span>
<span class=hs-linenum>258: </span>        <span class='hs-varid'>withBytesN</span> <span class='hs-varid'>signature</span> <span class='hs-varop'>$</span> <span class='hs-keyglyph'>\</span><span class='hs-varid'>psignature</span> <span class='hs-keyglyph'>-&gt;</span>
<span class=hs-linenum>259: </span>        <span class='hs-varid'>withPlaintext</span> <span class='hs-varid'>message</span> <span class='hs-varop'>$</span> <span class='hs-keyglyph'>\</span><span class='hs-varid'>pmessage</span> <span class='hs-keyglyph'>-&gt;</span>
<span class=hs-linenum>260: </span>        <span class='hs-varid'>sodium_sign_verify_detached</span> <span class='hs-varid'>psignature</span>
<span class=hs-linenum>261: </span>                                    <span class='hs-varid'>pmessage</span> <span class='hs-varid'>mlenC</span>
<span class=hs-linenum>262: </span>                                    <span class='hs-varid'>pkey</span>
<span class=hs-linenum>263: </span>  <span class='hs-keyword'>in</span> <span class='hs-keyword'>case</span> <span class='hs-varid'>e</span> <span class='hs-keyword'>of</span>
<span class=hs-linenum>264: </span>    <span class='hs-num'>0</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>True</span>
<span class=hs-linenum>265: </span>    <span class='hs-keyword'>_</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>False</span>
<span class=hs-linenum>266: </span>
<span class=hs-linenum>267: </span><span class='hs-keyword'>type</span> <span class='hs-conid'>PublicKeyBytes</span> <span class='hs-keyglyph'>=</span> <span class='hs-num'>32</span>
<span class=hs-linenum>268: </span><span class='hs-definition'>publicKeyBytes</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>ByteSize</span> <span class='hs-conid'>PublicKeyBytes</span>
<span class=hs-linenum>269: </span><span class='hs-definition'>publicKeyBytes</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>ByteSize</span>
<span class=hs-linenum>270: </span>
<span class=hs-linenum>271: </span><span class='hs-definition'>publicKeySize</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Int</span>
<span class=hs-linenum>272: </span><span class='hs-definition'>publicKeySize</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>fromIntegral</span> <span class='hs-varid'>sodium_sign_publickeybytes</span>
<span class=hs-linenum>273: </span>
<span class=hs-linenum>274: </span><span class='hs-keyword'>type</span> <span class='hs-conid'>SecretKeyBytes</span> <span class='hs-keyglyph'>=</span> <span class='hs-num'>64</span>
<span class=hs-linenum>275: </span><span class='hs-definition'>secretKeyBytes</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>ByteSize</span> <span class='hs-conid'>SecretKeyBytes</span>
<span class=hs-linenum>276: </span><span class='hs-definition'>secretKeyBytes</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>ByteSize</span>
<span class=hs-linenum>277: </span>
<span class=hs-linenum>278: </span><span class='hs-definition'>secretKeySize</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Int</span>
<span class=hs-linenum>279: </span><span class='hs-definition'>secretKeySize</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>fromIntegral</span> <span class='hs-varid'>sodium_sign_secretkeybytes</span>
<span class=hs-linenum>280: </span>
<span class=hs-linenum>281: </span><span class='hs-keyword'>type</span> <span class='hs-conid'>KeypairBytes</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>SecretKeyBytes</span> <span class='hs-varop'>+</span> <span class='hs-conid'>PublicKeyBytes</span>
<span class=hs-linenum>282: </span><span class='hs-definition'>keypairBytes</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>ByteSize</span> <span class='hs-conid'>KeypairBytes</span>
<span class=hs-linenum>283: </span><span class='hs-definition'>keypairBytes</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>ByteSize</span>
<span class=hs-linenum>284: </span>
<span class=hs-linenum>285: </span><span class='hs-definition'>keypairSize</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Int</span>
<span class=hs-linenum>286: </span><span class='hs-definition'>keypairSize</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>secretKeySize</span> <span class='hs-varop'>+</span> <span class='hs-varid'>publicKeySize</span>
<span class=hs-linenum>287: </span>
<span class=hs-linenum>288: </span><span class='hs-keyword'>type</span> <span class='hs-conid'>SignatureBytes</span> <span class='hs-keyglyph'>=</span> <span class='hs-num'>64</span>
<span class=hs-linenum>289: </span><span class='hs-definition'>signatureBytes</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>ByteSize</span> <span class='hs-conid'>SignatureBytes</span>
<span class=hs-linenum>290: </span><span class='hs-definition'>signatureBytes</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>ByteSize</span>
<span class=hs-linenum>291: </span>
<span class=hs-linenum>292: </span><span class='hs-definition'>signatureSize</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Int</span>
<span class=hs-linenum>293: </span><span class='hs-definition'>signatureSize</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>fromIntegral</span> <span class='hs-varid'>sodium_sign_bytes</span>
<span class=hs-linenum>294: </span>
<span class=hs-linenum>295: </span><span class='hs-keyword'>type</span> <span class='hs-conid'>SeedBytes</span> <span class='hs-keyglyph'>=</span> <span class='hs-num'>32</span>
<span class=hs-linenum>296: </span><span class='hs-definition'>seedBytes</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>ByteSize</span> <span class='hs-conid'>SeedBytes</span>
<span class=hs-linenum>297: </span><span class='hs-definition'>seedBytes</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>ByteSize</span>
<span class=hs-linenum>298: </span>
<span class=hs-linenum>299: </span><span class='hs-definition'>seedSize</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Int</span>
<span class=hs-linenum>300: </span><span class='hs-definition'>seedSize</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>fromIntegral</span> <span class='hs-varid'>sodium_sign_seedbytes</span>
</pre>
</body>
</html>